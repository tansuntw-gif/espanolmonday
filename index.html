<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿èªå­¸ç¿’å¤§å¸« - 20èª²å…¨é›†</title>
    <style>
        :root { --primary: #007AFF; --secondary: #6c757d; --success: #34C759; --danger: #FF3B30; }
        body { font-family: -apple-system, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { width: 90%; max-width: 450px; padding: 25px; background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        
        /* é¸å–®æ¨£å¼ */
        .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 20px; max-height: 400px; overflow-y: auto; padding: 5px; }
        .lesson-btn { background: white; border: 2px solid var(--primary); color: var(--primary); padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .lesson-btn:hover { background: var(--primary); color: white; }

        /* ç·´ç¿’å€æ¨£å¼ */
        .quiz-container { display: none; }
        .stats-bar { display: flex; justify-content: space-between; font-size: 14px; color: #666; margin-bottom: 15px; }
        #chinese-text { font-size: 22px; font-weight: bold; margin: 20px 0; min-height: 50px; color: #333; }
        input[type="text"] { width: 100%; padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 12px; margin-bottom: 15px; text-align: center; outline: none; }
        input[type="text"]:focus { border-color: var(--primary); }
        .ans-display { font-size: 18px; color: var(--primary); font-weight: bold; margin-bottom: 15px; display: none; background: #eef7ff; padding: 10px; border-radius: 10px; cursor: pointer; }
        
        button.action-btn { width: 100%; border: none; padding: 15px; border-radius: 12px; font-size: 18px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn-check { background: var(--primary); color: white; }
        .btn-next { background: var(--secondary); color: white; }
        .btn-back { background: none; color: var(--secondary); font-size: 14px; text-decoration: underline; }
    </style>
</head>
<body>

<div class="card" id="menu-screen">
    <h2 style="margin-top:0">é¸æ“‡èª²ç¨‹</h2>
    <p style="color:#666">å…± 20 èª²ï¼Œé»æ“Šé–‹å§‹ç·´ç¿’</p>
    <div class="menu-grid" id="lesson-menu">
        </div>
</div>

<div class="card quiz-container" id="quiz-screen">
    <div class="stats-bar">
        <div id="current-lesson-name">Lesson 7</div>
        <div id="progress">1 / 10</div>
        <div id="score">å¾—åˆ†: 0</div>
    </div>
    
    <div id="chinese-text">é¡Œç›®è¼‰å…¥ä¸­...</div>
    <input type="text" id="user-input" placeholder="è«‹è¼¸å…¥è¥¿æ–‡..." autocomplete="off">
    
    <div id="feedback" style="margin-bottom:10px; font-weight:bold;"></div>
    <div id="ans-display" class="ans-display" onclick="speak()"></div>

    <div class="btn-group">
        <button id="check-btn" class="action-btn btn-check" onclick="checkAnswer()">æª¢æŸ¥ç­”æ¡ˆ</button>
        <button class="action-btn btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
        <button class="btn-back" onclick="goToMenu()">å›ä¸»é¸å–®</button>
    </div>
</div>

<script>
    // --- é¡Œåº«è³‡æ–™å€ (ä½ å¯ä»¥åœ¨é€™è£¡æŒçºŒå¢åŠ åˆ° 20 èª²) ---
    const allLessons = {
        "ç¬¬ 1 èª²ï¼šå®Œæ•´å°è©±ç·´ç¿’": [
            { ch: "æ—©å®‰ã€‚", sp: "Buenos dÃ­as" },
            { ch: "åˆå®‰/å‚æ™šå¥½ã€‚", sp: "Buenas tardes" },
            { ch: "æ™šå®‰ã€‚", sp: "Buenas noches" },
            { ch: "ä½ å¥½å—ï¼Ÿ(ä½ )", sp: "Â¿CÃ³mo estÃ¡s?" },
            { ch: "æˆ‘å¾ˆå¥½ï¼Œè¬è¬ã€‚", sp: "Bien, gracias" },
            { ch: "ä½ å‘¢ï¼Ÿ", sp: "Â¿Y tÃº?" },
            { ch: "æˆ‘ä¹Ÿå¾ˆå¥½ã€‚", sp: "Yo tambiÃ©n estoy bien" },
            { ch: "æ‚¨å¥½å—ï¼Ÿ(æ‚¨)", sp: "Â¿CÃ³mo estÃ¡ usted?" },
            { ch: "éå¸¸æœ‰ç¦®è²Œåœ°å›ç­”ï¼šæˆ‘å¾ˆå¥½ã€‚", sp: "Muy bien, gracias" },
            { ch: "æœ€è¿‘æ€éº¼æ¨£ï¼Ÿ", sp: "Â¿QuÃ© tal?" },
            { ch: "ä¸€åˆ‡éƒ½å¥½å—ï¼Ÿ", sp: "Â¿CÃ³mo va todo?" },
            { ch: "ç™¼ç”Ÿä»€éº¼äº‹äº†ï¼Ÿ/ æ€éº¼äº†ï¼Ÿ", sp: "Â¿QuÃ© pasa?" },
            { ch: "æœ‰ä»€éº¼æ–°é®®äº‹ï¼Ÿ", sp: "Â¿QuÃ© hay?" },
            { ch: "é‚„å¯ä»¥/æ™®é€šã€‚", sp: "Regular" },
            { ch: "ä¸å¤ªå¥½ã€‚", sp: "No muy bien" },
            { ch: "å†è¦‹ã€‚", sp: "AdiÃ³s" },
            { ch: "å¾…æœƒè¦‹ã€‚", sp: "Hasta luego" },
            { ch: "å¾ˆå¿«è¦‹ã€‚", sp: "Hasta pronto" },
            { ch: "æ˜å¤©è¦‹ã€‚", sp: "Hasta maÃ±ana" },
            { ch: "æ”¹å¤©è¦‹ã€‚", sp: "Hasta otro dÃ­a" },
            { ch: "é€™ä¸‹åˆæˆ‘æœ‰å€‹é¢è©¦ã€‚", sp: "Tengo una entrevista esta tarde" },
            { ch: "ç¥ä½ å¥½é‹ï¼", sp: "Â¡Mucha suerte!" },
            { ch: "åŠ æ²¹ï¼", sp: "Â¡Ãnimo!" },
            { ch: "è¬è¬ï¼Œå†è¦‹ã€‚", sp: "Gracias, adiÃ³s" }
        ],
        // ä¹‹å¾Œæˆ‘å€‘æœƒä¾ç…§é€™å€‹æ¨™æº–ç¹¼çºŒè£œå®Œç¬¬ 2 èª²åˆ°ç¬¬ 20 èª²
"ç¬¬ 2 èª²ï¼šæˆ‘æ˜¯è¥¿ç­ç‰™äºº (å®Œæ•´å°è©±)": [
            { ch: "ä½ å«ä»€éº¼åå­—ï¼Ÿ", sp: "Â¿CÃ³mo te llamas?" },
            { ch: "æˆ‘å«å¤§è¡›ã€‚", sp: "Me llamo David" },
            { ch: "ä½ å«ä»€éº¼åå­—ï¼Ÿ(æ‚¨/æ­£å¼)", sp: "Â¿CÃ³mo se llama usted?" },
            { ch: "æˆ‘å«å®‰å¨œã€‚", sp: "Me llamo Ana" },
            { ch: "å¾ˆé«˜èˆˆèªè­˜ä½ ã€‚", sp: "Mucho gusto" },
            { ch: "å¹¸æœƒã€‚(ç”·ç”Ÿç”¨)", sp: "Encantado" },
            { ch: "å¹¸æœƒã€‚(å¥³ç”Ÿç”¨)", sp: "Encantada" },
            { ch: "ä½ å¾å“ªè£¡ä¾†ï¼Ÿ", sp: "Â¿De dÃ³nde eres?" },
            { ch: "æˆ‘ä¾†è‡ªè¥¿ç­ç‰™ã€‚", sp: "Soy de EspaÃ±a" },
            { ch: "æˆ‘æ˜¯è¥¿ç­ç‰™äººã€‚(å¥³ç”Ÿ)", sp: "Soy espaÃ±ola" },
            { ch: "æˆ‘æ˜¯è¥¿ç­ç‰™äººã€‚(ç”·ç”Ÿ)", sp: "Soy espaÃ±ol" },
            { ch: "é‚£æ˜¯å€‹éå¸¸æ¼‚äº®çš„åŸå¸‚ã€‚", sp: "Es una ciudad muy bonita" },
            { ch: "å¥¹æ˜¯å…‹é‡Œæ–¯è’‚å¨œã€‚", sp: "Ella es Cristina" },
            { ch: "å¥¹æ˜¯å­¸ç”Ÿå—ï¼Ÿ", sp: "Â¿Es estudiante?" },
            { ch: "ä¸ï¼Œå¥¹æ˜¯è€å¸«ã€‚", sp: "No, es profesora" },
            { ch: "å¥¹æ˜¯è¥¿ç­ç‰™æ–‡è€å¸«ã€‚", sp: "Es profesora de espaÃ±ol" },
            { ch: "å®‰å¨œåœ¨å°ç£ã€‚", sp: "Ana estÃ¡ en TaiwÃ¡n" },
            { ch: "æˆ‘å¾ˆå¥½ã€‚", sp: "Estoy bien" },
            { ch: "æˆ‘æ˜¯æ³•åœ‹äººã€‚(ç”·ç”Ÿ)", sp: "Soy francÃ©s" },
            { ch: "æˆ‘æ˜¯æ³•åœ‹äººã€‚(å¥³ç”Ÿ)", sp: "Soy francesa" },
            { ch: "å¥¹çš„çˆ¶è¦ªæ˜¯è¥¿ç­ç‰™äººã€‚", sp: "Su padre es espaÃ±ol" },
            { ch: "å¥¹çš„æ¯è¦ªæ˜¯æ—¥æœ¬äººã€‚", sp: "Su madre es japonesa" },
            { ch: "æˆ‘ä½åœ¨å·´é»ã€‚", sp: "Vivo en ParÃ­s" },
            { ch: "å·´é»æ˜¯æ³•åœ‹çš„é¦–éƒ½ã€‚", sp: "ParÃ­s es la capital de Francia" }
        ],
"ç¬¬ 3 èª²ï¼šè·æ¥­èˆ‡å·¥ä½œ (å®Œæ•´å°è©±)": [
            { ch: "ä½ åšä»€éº¼å·¥ä½œï¼Ÿ", sp: "Â¿QuÃ© haces?" },
            { ch: "ä½ æ˜¯åšä»€éº¼çš„ï¼Ÿ", sp: "Â¿A quÃ© te dedicas?" },
            { ch: "æ‚¨æ˜¯åšä»€éº¼çš„ï¼Ÿ(æ­£å¼)", sp: "Â¿A quÃ© se dedica usted?" },
            { ch: "æ‚¨ç¾åœ¨å¾äº‹ä»€éº¼å·¥ä½œï¼Ÿ(æ­£å¼)", sp: "Â¿A quÃ© se dedica ahora?" },
            { ch: "æˆ‘æ˜¯å­¸ç”Ÿã€‚", sp: "Soy estudiante" },
            { ch: "æˆ‘æ˜¯å¤§å­¸ç”Ÿã€‚", sp: "Soy estudiante de la universidad" },
            { ch: "ä½ åœ¨å“ªè£¡å·¥ä½œï¼Ÿ", sp: "Â¿DÃ³nde trabajas?" },
            { ch: "æˆ‘åœ¨ä¸€å®¶å’–å•¡é¤¨å·¥ä½œã€‚", sp: "Trabajo en una cafeterÃ­a" },
            { ch: "ä½ æ˜¯å­¸ç”Ÿï¼Œä½†ä½ åœ¨å’–å•¡é¤¨ç•¶åº—å“¡ã€‚", sp: "Eres estudiante pero estÃ¡s de camarero en una cafeterÃ­a" },
            { ch: "ä½ åœ¨å“ªè£¡å”¸æ›¸ï¼Ÿ", sp: "Â¿DÃ³nde estudias?" },
            { ch: "æˆ‘åœ¨å°åŒ—å”¸æ›¸ã€‚", sp: "Estudio en TaipÃ©i" },
            { ch: "ä½ æœƒèªªè‹±æ–‡å—ï¼Ÿ", sp: "Â¿Hablas inglÃ©s?" },
            { ch: "æˆ‘èªªå¾—ä¸€å£æµåˆ©çš„è‹±æ–‡ã€‚", sp: "Hablo muy bien inglÃ©s" },
            { ch: "æˆ‘æœƒèªªä¸€é»é»è¥¿ç­ç‰™æ–‡ã€‚", sp: "Hablo un poco de espaÃ±ol" },
            { ch: "æˆ‘ç¾åœ¨æ²’æœ‰å·¥ä½œã€‚", sp: "Ahora no tengo trabajo" },
            { ch: "æˆ‘åœ¨æ‰¾å·¥ä½œã€‚", sp: "Busco trabajo" },
            { ch: "æˆ‘åœ¨ä¸€å®¶ä¸­å­¸ç•¶è‹±æ–‡è€å¸«ã€‚", sp: "Trabajo como profesor de inglÃ©s en un instituto" },
            { ch: "æˆ‘åœ¨å¹¼å…’åœ’ç•¶è€å¸«ã€‚", sp: "Trabajo como maestro en una guarderÃ­a" },
            { ch: "æˆ‘åœ¨å­¸æ ¡å·¥ä½œã€‚", sp: "Trabajo en una escuela" },
            { ch: "æˆ‘åœ¨éŠ€è¡Œæ“”ä»»å‡ºç´å“¡ã€‚", sp: "Trabajo de cajero en un banco" },
            { ch: "æˆ‘åœ¨é¤å»³ç•¶æœå‹™ç”Ÿã€‚", sp: "Estoy de camarera en un restaurante" },
            { ch: "æˆ‘åœ¨é†«é™¢å·¥ä½œï¼Œæˆ‘æ˜¯è­·å£«ã€‚", sp: "Trabajo en un hospital, soy enfermera" },
            { ch: "æˆ‘æ˜¯ç¸é†«ã€‚", sp: "Soy veterinario" },
            { ch: "ä½ åœ¨é€™å®¶éŠ€è¡Œå·¥ä½œå¾ˆä¹…äº†å—ï¼Ÿ", sp: "Â¿Llevas mucho tiempo trabajando en este banco?" },
            { ch: "ä¸ï¼Œæˆ‘å‰›é–‹å§‹ã€‚", sp: "No, acabo de empezar" },
            { ch: "é€™æ˜¯ä¸€ä»½å…¼è·å·¥ä½œã€‚", sp: "Es un puesto a tiempo parcial" },
            { ch: "é€™æ˜¯ä¸€ä»½å…¨è·å·¥ä½œã€‚", sp: "Es un trabajo a tiempo completo" },
            { ch: "å·¥ä½œæ™‚é–“å¾ˆå½ˆæ€§ã€‚", sp: "El horario es flexible" },
            { ch: "æˆ‘å–œæ­¡æˆ‘çš„å·¥ä½œã€‚", sp: "Me gusta mi trabajo" }
        ],
"ç¬¬ 4 èª²ï¼šæˆ‘ä¸èˆ’æœ (å®Œæ•´å°è©±)": [
            { ch: "ä½ é‚„å¥½å—ï¼Ÿ", sp: "Â¿EstÃ¡s bien?" },
            { ch: "ä½ çœ‹èµ·ä¾†è‡‰è‰²ä¸å¤ªå¥½ã€‚", sp: "Tienes mala cara" },
            { ch: "ä¸ï¼Œæˆ‘ä¸å¤ªå¥½ã€‚", sp: "No, no estoy bien" },
            { ch: "æˆ‘ç”Ÿç—…äº†ã€‚(å¥³ç”Ÿèªª)", sp: "Estoy enferma" },
            { ch: "æˆ‘ç”Ÿç—…äº†ã€‚(ç”·ç”Ÿèªª)", sp: "Estoy enfermo" },
            { ch: "ä½ æ€éº¼äº†ï¼Ÿ", sp: "Â¿QuÃ© te pasa?" },
            { ch: "æˆ‘ç™¼ç‡’äº†ã€‚", sp: "Tengo fiebre" },
            { ch: "æˆ‘éå¸¸ç´¯ã€‚(å¥³ç”Ÿèªª)", sp: "Estoy muy cansada" },
            { ch: "æˆ‘éå¸¸ç´¯ã€‚(ç”·ç”Ÿèªª)", sp: "Estoy muy cansado" },
            { ch: "æˆ‘ç²¾ç–²åŠ›ç«­ã€‚(å¥³ç”Ÿèªª)", sp: "Estoy agotada" },
            { ch: "æˆ‘ç²¾ç–²åŠ›ç«­ã€‚(ç”·ç”Ÿèªª)", sp: "Estoy agotado" },
            { ch: "ä½ å¿…é ˆå»çœ‹é†«ç”Ÿã€‚", sp: "Tienes que ir al mÃ©dico" },
            { ch: "æ˜¯çœŸçš„ã€‚", sp: "Es verdad" },
            { ch: "æ˜¯çš„ï¼Œæˆ‘æœ‰ç™¼ç‡’ã€‚", sp: "SÃ­, tengo fiebre" },
            { ch: "é€™ä¸‹åˆæˆ‘æœ‰å€‹é¢è©¦ã€‚", sp: "Tengo una entrevista esta tarde" },
            { ch: "æˆ‘æœ‰é»ç·Šå¼µã€‚(ç”·ç”Ÿèªª)", sp: "Estoy un poco nervioso" },
            { ch: "æˆ‘æœ‰é»ç·Šå¼µã€‚(å¥³ç”Ÿèªª)", sp: "Estoy un poco nerviosa" },
            { ch: "åŠ æ²¹ï¼", sp: "Â¡Ãnimo!" },
            { ch: "ç¥ä½ å¥½é‹ï¼", sp: "Â¡Mucha suerte!" },
            { ch: "è¬è¬ã€‚", sp: "Gracias" },
            { ch: "ä½ ä¸åƒæŠ«è–©å—ï¼Ÿ", sp: "Â¿No comes la pizza?" },
            { ch: "é€™æŠ«è–©å¾ˆå¥½åƒã€‚", sp: "Esta pizza estÃ¡ deliciosa" },
            { ch: "ä¸ï¼Œæˆ‘ä¸é¤“ã€‚", sp: "No, no tengo hambre" },
            { ch: "ä½ ä¸é¤“å—ï¼Ÿ", sp: "Â¿No tienes hambre?" },
            { ch: "æˆ‘é€™ä¸‹åˆæ²’å·¥ä½œã€‚", sp: "No tengo trabajo esta tarde" },
            { ch: "æˆ‘è¦å»é†«é™¢ã€‚", sp: "Voy al mÃ©dico" },
            { ch: "æˆ‘å¾ˆç´¯ä¸”æƒ³ç¡è¦ºã€‚", sp: "Estoy muy cansado y tengo sueÃ±o" },
            { ch: "æˆ‘å¾ˆç´¯ã€‚(ç”·ç”Ÿèªª)", sp: "Estoy muy cansado" },
            { ch: "æˆ‘å¾ˆç´¯ã€‚(å¥³ç”Ÿèªª)", sp: "Estoy muy cansada" }
        ],
    };

    let currentLesson = [];
    let currentIndex = 0;
    let currentScore = 0;
    let selectedLessonName = "";

    // 1. åˆå§‹åŒ–é¸å–®
    function initMenu() {
        const menu = document.getElementById('lesson-menu');
        menu.innerHTML = "";
        Object.keys(allLessons).forEach(name => {
            const btn = document.createElement('button');
            btn.className = 'lesson-btn';
            btn.innerText = name;
            btn.onclick = () => startLesson(name);
            menu.appendChild(btn);
        });
    }

    // 2. é–‹å§‹ç‰¹å®šèª²ç¨‹
    function startLesson(name) {
        selectedLessonName = name;
        currentLesson = [...allLessons[name]].sort(() => Math.random() - 0.5); // éš¨æ©Ÿæ´—ç‰Œ
        currentIndex = 0;
        currentScore = 0;
        
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        document.getElementById('current-lesson-name').innerText = name;
        showQuestion();
    }

   // 3. é¡¯ç¤ºé¡Œç›®ï¼ˆæ–°å¢ï¼šè¼¸å…¥æ¡†ç›£è½å™¨ï¼‰
    function showQuestion() {
        const q = currentLesson[currentIndex];
        document.getElementById('chinese-text').innerText = q.ch;
        
        const userInput = document.getElementById('user-input');
        userInput.value = "";
        userInput.style.borderColor = "#ddd"; // æ¢å¾©é‚Šæ¡†é¡è‰²
        
        document.getElementById('feedback').innerText = "";
        document.getElementById('ans-display').style.display = "none";
        
        const checkBtn = document.getElementById('check-btn');
        checkBtn.disabled = false;
        checkBtn.innerText = "æª¢æŸ¥ç­”æ¡ˆ";

        document.getElementById('progress').innerText = `${currentIndex + 1} / ${currentLesson.length}`;
        document.getElementById('score').innerText = `å¾—åˆ†: ${currentScore}`;
        userInput.focus();

        // ã€ä¿®æ­£é»ã€‘ç›£è½è¼¸å…¥äº‹ä»¶ï¼šç•¶ä½¿ç”¨è€…æ‰“å­—æ™‚ï¼Œé‡æ–°å•Ÿç”¨æŒ‰éˆ•
        userInput.oninput = function() {
            checkBtn.disabled = false;
            checkBtn.innerText = "æª¢æŸ¥ç­”æ¡ˆ";
            userInput.style.borderColor = "#007AFF"; 
        };
    }

    // 4. æª¢æŸ¥ç­”æ¡ˆ
    // è¼”åŠ©å‡½æ•¸ï¼šå»é™¤é‡éŸ³ç¬¦è™Ÿä»¥é€²è¡Œæ¯”å°
    function removeAccents(str) {
        return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    }

    function checkAnswer() {
        const userInput = document.getElementById('user-input');
        const rawUserValue = userInput.value.trim();
        
        // æ­£è¦åŒ–ï¼šè½‰å°å¯«ã€å»æ¨™é»ã€å»é‡éŸ³
        const userClean = removeAccents(rawUserValue.toLowerCase().replace(/[Â¿?.,!]/g, ""));
        const correctClean = removeAccents(currentLesson[currentIndex].sp.toLowerCase().replace(/[Â¿?.,!]/g, ""));
        
        const feedback = document.getElementById('feedback');
        const ansDisp = document.getElementById('ans-display');
        const checkBtn = document.getElementById('check-btn');

        if (userClean === correctClean) {
            // åˆ¤å®šæ­£ç¢º
            currentScore += 10;
            
            // æª¢æŸ¥æ˜¯å¦æœ‰é‡éŸ³æ‰“éŒ¯ï¼ˆåŸå§‹å­—ä¸²æ¯”å°ï¼‰
            const isAccentsPerfect = rawUserValue.replace(/[Â¿?.,!]/g, "") === currentLesson[currentIndex].sp.replace(/[Â¿?.,!]/g, "");
            
            if (!isAccentsPerfect) {
                feedback.innerText = "ç­”å°äº†ï¼ä½†è¦æ³¨æ„é‡éŸ³ç¬¦è™Ÿï¼š";
                feedback.style.color = "#FF9500"; // æ©˜è‰²æé†’
            } else {
                feedback.innerText = "Â¡Perfecto! å…¨å°ï¼ğŸŒŸ";
                feedback.style.color = "var(--success)";
            }

            // è™•ç†é¡¯ç¤ºç­”æ¡ˆï¼šå°‡å«æœ‰ç‰¹æ®Šç¬¦è™Ÿçš„å–®å­—è®Šç´…
            const words = currentLesson[currentIndex].sp.split(' ');
            const highlightedAns = words.map(word => {
                // å¦‚æœå–®å­—åŒ…å«ç‰¹æ®Šå­—å…ƒï¼Œå‰‡æ¨™ç´…
                if (/[Ã¡Ã©Ã­Ã³ÃºÃ±ÃÃ‰ÃÃ“ÃšÃ‘]/.test(word)) {
                    return `<span style="color: red; font-weight: bold;">${word}</span>`;
                }
                return word;
            }).join(' ');

            userInput.style.borderColor = "var(--success)";
            ansDisp.innerHTML = highlightedAns + " ğŸ”Š";
            ansDisp.style.display = "block";
            checkBtn.disabled = true;
            checkBtn.innerText = "å·²å®Œæˆ";
            speak();
        } else {
            // åˆ¤å®šéŒ¯èª¤
            feedback.innerText = "æ‹¼å­—æœ‰èª¤ï¼Œå†è©¦è©¦çœ‹ï¼";
            feedback.style.color = "var(--danger)";
            userInput.style.borderColor = "var(--danger)";
            
            ansDisp.innerText = "æŸ¥çœ‹æ­£ç¢ºç­”æ¡ˆï¼Ÿ (é»æ“Šæ­¤è™•) ğŸ”Š";
            ansDisp.onclick = function() {
                // éŒ¯èª¤æ™‚æŸ¥çœ‹ç­”æ¡ˆä¹Ÿé¡¯ç¤ºç´…å­—æé†’
                const words = currentLesson[currentIndex].sp.split(' ');
                ansDisp.innerHTML = words.map(word => /[Ã¡Ã©Ã­Ã³ÃºÃ±ÃÃ‰ÃÃ“ÃšÃ‘]/.test(word) ? `<span style="color: red;">${word}</span>` : word).join(' ') + " ğŸ”Š";
                speak();
            };
            ansDisp.style.display = "block";
        }
    }

    // 5. ä¸‹ä¸€é¡Œ
    function nextQuestion() {
        if (currentIndex < currentLesson.length - 1) {
            currentIndex++;
            showQuestion();
        } else {
            alert(`èª²ç¨‹å®Œæˆï¼ç¸½åˆ†ï¼š${currentScore}`);
            goToMenu();
        }
    }

    function goToMenu() {
        document.getElementById('menu-screen').style.display = 'block';
        document.getElementById('quiz-screen').style.display = 'none';
    }

    function speak() {
        const utterance = new SpeechSynthesisUtterance(currentLesson[currentIndex].sp);
        utterance.lang = 'es-ES';
        window.speechSynthesis.speak(utterance);
    }

    initMenu();
</script>

</body>
</html>



