<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿èªå­¸ç¿’å¤§å¸« - 20èª²å…¨é›†</title>
    <style>
        :root { --primary: #007AFF; --secondary: #6c757d; --success: #34C759; --danger: #FF3B30; }
        body { font-family: -apple-system, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { width: 90%; max-width: 450px; padding: 25px; background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        
        /* é¸å–®æ¨£å¼ */
        .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 20px; max-height: 400px; overflow-y: auto; padding: 5px; }
        .lesson-btn { background: white; border: 2px solid var(--primary); color: var(--primary); padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .lesson-btn:hover { background: var(--primary); color: white; }

        /* ç·´ç¿’å€æ¨£å¼ */
        .quiz-container { display: none; }
        .stats-bar { display: flex; justify-content: space-between; font-size: 14px; color: #666; margin-bottom: 15px; }
        #chinese-text { font-size: 22px; font-weight: bold; margin: 20px 0; min-height: 50px; color: #333; }
        input[type="text"] { width: 100%; padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 12px; margin-bottom: 15px; text-align: center; outline: none; }
        input[type="text"]:focus { border-color: var(--primary); }
        .ans-display { font-size: 18px; color: var(--primary); font-weight: bold; margin-bottom: 15px; display: none; background: #eef7ff; padding: 10px; border-radius: 10px; cursor: pointer; }
        
        button.action-btn { width: 100%; border: none; padding: 15px; border-radius: 12px; font-size: 18px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn-check { background: var(--primary); color: white; }
        .btn-next { background: var(--secondary); color: white; }
        .btn-back { background: none; color: var(--secondary); font-size: 14px; text-decoration: underline; }
    </style>
</head>
<body>

<div class="card" id="menu-screen">
    <h2 style="margin-top:0">é¸æ“‡èª²ç¨‹</h2>
    <p style="color:#666">å…± 20 èª²ï¼Œé»æ“Šé–‹å§‹ç·´ç¿’</p>
    <div class="menu-grid" id="lesson-menu">
        </div>
</div>

<div class="card quiz-container" id="quiz-screen">
    <div class="stats-bar">
        <div id="current-lesson-name">Lesson 7</div>
        <div id="progress">1 / 10</div>
        <div id="score">å¾—åˆ†: 0</div>
    </div>
    
    <div id="chinese-text">é¡Œç›®è¼‰å…¥ä¸­...</div>
    <input type="text" id="user-input" placeholder="è«‹è¼¸å…¥è¥¿æ–‡..." autocomplete="off">
    
    <div id="feedback" style="margin-bottom:10px; font-weight:bold;"></div>
    <div id="ans-display" class="ans-display" onclick="speak()"></div>

    <div class="btn-group">
        <button id="check-btn" class="action-btn btn-check" onclick="checkAnswer()">æª¢æŸ¥ç­”æ¡ˆ</button>
        <button class="action-btn btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
        <button class="btn-back" onclick="goToMenu()">å›ä¸»é¸å–®</button>
    </div>
</div>

<script>
    // --- é¡Œåº«è³‡æ–™å€ (ä½ å¯ä»¥åœ¨é€™è£¡æŒçºŒå¢åŠ åˆ° 20 èª²) ---
    const allLessons = {

"ç¬¬ 5 èª²ï¼šÂ¿DÃ³nde estÃ¡ la estaciÃ³n? (è»Šç«™åœ¨å“ªè£¡ï¼Ÿ)": [
            // 05-101: å•è·¯
            { ch: "ä¸å¥½æ„æ€ï¼Œæ™®æ‹‰å¤šåšç‰©é¤¨åœ¨å“ªè£¡ï¼Ÿ", sp: "Perdone, Â¿dÃ³nde estÃ¡ el museo del Prado?" },
            { ch: "é›¢é€™è£¡æœ‰ä¸€é»é ã€‚ä½ å¾—æ­åœ°éµã€‚", sp: "EstÃ¡ un poco lejos de aquÃ­. Tienes que coger el metro." },
            { ch: "åœ°éµç«™åœ¨å“ªè£¡ï¼Ÿé›¢é€™è£¡å¾ˆè¿‘ã€‚å°±åœ¨æ›¸å ±æ”¤å°é¢ã€‚", sp: "Â¿DÃ³nde estÃ¡ la estaciÃ³n de metro? EstÃ¡ cerca de aquÃ­. EstÃ¡ enfrente del quiosco." },
            { ch: "éå¸¸æ„Ÿè¬ã€‚ / ä¸å®¢æ°£ã€‚", sp: "Muchas gracias. De nada." },
            
            // 05-102: æ„å¤–ç›¸é‡
            { ch: "å—¨ï¼Œå®‰æ±å°¼å¥§ã€‚çœŸå·§ã€‚ä½ ä½åœ¨é€™é™„è¿‘å—ï¼Ÿ", sp: "Hola, Antonio. QuÃ© casualidad. Â¿Vives cerca de aquÃ­?" },
            { ch: "ä¸ï¼Œæˆ‘åœ¨é€™è£¡æ˜¯å› ç‚ºæˆ‘å’Œå¥³æœ‹å‹æœ‰ç´„ã€‚", sp: "No, estoy aquÃ­ porque tengo una cita con mi novia." },
            { ch: "ä½ ç¾åœ¨ä½åœ¨å“ªè£¡ï¼Ÿæˆ‘ä½åœ¨åˆç§Ÿå…¬å¯“ã€‚å…¬å¯“åœ¨ç´¢é‡Œäºè¡—ã€‚", sp: "Â¿DÃ³nde vives ahora? Vivo en un piso compartido. El piso estÃ¡ en la calle Zorrilla." },
            
            // 05-206: æƒ…æ„Ÿç‹€æ…‹
            { ch: "æˆ‘ç­‹ç–²åŠ›ç«­ï¼Œå› ç‚ºæˆ‘æœ‰å¾ˆå¤šå·¥ä½œã€‚", sp: "Estoy agotado porque tengo mucho trabajo." },
            
            // 05-204 & 05-302: å±…ä½ä½ç½®èˆ‡æ–¹ä½ç·´ç¿’
            { ch: "ä½ ä¾†è‡ªå“ªè£¡ï¼Ÿæˆ‘ä¾†è‡ªé¦¬å¾·é‡Œã€‚", sp: "Â¿De dÃ³nde eres tÃº? Yo soy de Madrid." },
            { ch: "ä½ ä½åœ¨å“ªè£¡ï¼Ÿæˆ‘å’Œæœ‹å‹ä½åœ¨ä¸€é–“å…¬å¯“è£¡ã€‚", sp: "Â¿DÃ³nde vives? Vivo en un piso con mi amigo." },
            { ch: "å…¬å¯“åœ¨å“ªè£¡ï¼Ÿå…¬å¯“åœ¨ä¸€å®¶éºµåŒ…åº—å°é¢ã€‚", sp: "Â¿DÃ³nde estÃ¡ el piso? El piso estÃ¡ enfrente de una panaderÃ­a." },
            { ch: "éºµåŒ…åº—åœ¨å“ªè£¡ï¼Ÿå®ƒåœ¨æ•™å ‚å‰é¢ï¼Œå»£å ´å¾Œé¢ã€‚", sp: "Â¿DÃ³nde estÃ¡ la panaderÃ­a? EstÃ¡ delante de la iglesia y detrÃ¡s de la plaza." },
            { ch: "å…¬å¯“åœ¨å ±æ”¤æ—é‚Šå—ï¼Ÿå…¬å¯“å°±åœ¨é‚£è£¡ã€‚", sp: "Â¿EstÃ¡ el piso al lado de un quiosco? AllÃ­ estÃ¡ el piso." },
            
            // 05-401: Elisa çš„è¿‘æ³èˆ‡æ–°å®¶
            { ch: "Elisaï¼Œå¦³ä¸ˆå¤«åœ¨å“ªè£¡ï¼Ÿä»–åœ¨æ³•åœ‹å‡ºå·®ã€‚", sp: "Elisa, Â¿dÃ³nde estÃ¡ tu marido? EstÃ¡ de viaje de negocios por Francia." },
            { ch: "æ˜å¤©ä»–åœ¨å·´é»æœ‰ä¸€å€‹æœƒè­°ã€‚", sp: "MaÃ±ana tiene una reuniÃ³n en ParÃ­s." },
            { ch: "ä½ å€‘ç¾åœ¨ä½åœ¨é¦¬å¾·é‡Œå—ï¼Ÿä¸ï¼Œæˆ‘å€‘åœ¨è–©æ‹‰æ›¼å¡è²·äº†ä¸€æ£Ÿåˆ¥å¢…ã€‚", sp: "Â¿VivÃ­s en Madrid ahora? No, mi marido y yo compramos un chalÃ© en Salamanca." },
            { ch: "é›¢å¸‚ä¸­å¿ƒæœ‰é»é ï¼Œä½†åœ¨ä¸€å€‹éå¸¸å®‰éœçš„å€åŸŸã€‚", sp: "EstÃ¡ un poco lejos del centro, pero estÃ¡ en una zona muy tranquila." },
            
            // é¡å¤–ç·´ç¿’
            { ch: "æ‰‹æ©Ÿåœ¨å“ªè£¡ï¼Ÿæ‰‹æ©Ÿåœ¨æ¡Œå­ä¸Šã€‚", sp: "Â¿DÃ³nde estÃ¡ el mÃ³vil? El mÃ³vil estÃ¡ encima de la mesa." },
            { ch: "ä½ çˆ¶è¦ªåœ¨å“ªè£¡å·¥ä½œï¼Ÿæˆ‘çˆ¶è¦ªåœ¨ä¸€æ‰€å­¸æ ¡å·¥ä½œã€‚", sp: "Â¿DÃ³nde trabaja tu padre? Mi padre trabaja en una escuela." }
        ],
"ç¬¬ 6 èª²ï¼šHay comedor en la facultad (å­¸é™¢è£¡æœ‰é£Ÿå ‚)": [
            // 06-101: å­¸é™¢è¨­æ–½ä½ç½®
            { ch: "ä½ çŸ¥é“åœ–æ›¸é¤¨åœ¨å“ªè£¡å—ï¼Ÿå°±åœ¨å½±å°åº—æ—é‚Šã€‚", sp: "Â¿Sabes dÃ³nde estÃ¡ la biblioteca? EstÃ¡ ahÃ­, al lado de la tienda de fotocopias." },
            { ch: "å­¸é™¢è£¡æœ‰é£Ÿå ‚æˆ–å’–å•¡å»³å—ï¼Ÿ", sp: "Â¿Hay un comedor o una cafeterÃ­a en la facultad?" },
            { ch: "æ˜¯çš„ï¼Œé€™ä¸€å±¤æœ‰ä¸€é–“å’–å•¡å»³å’Œä¸€å€‹é£Ÿå ‚ã€‚", sp: "SÃ­, hay una cafeterÃ­a y un comedor en esta planta." },
            { ch: "ä¸€æ¨“æœ‰ä»€éº¼ï¼Ÿæœ‰ä¸€äº›æ•™å®¤ï¼Œç§˜æ›¸è™•ä¹Ÿåœ¨é‚£è£¡ã€‚", sp: "Â¿QuÃ© hay en la primera planta? Hay unas aulas y la SecretarÃ­a estÃ¡ allÃ­ tambiÃ©n." },
            { ch: "æˆ‘æ˜ç™½äº†ã€‚éå¸¸æ„Ÿè¬ã€‚", sp: "Ya veo. Muchas gracias." },

            // 06-102: æ•™å®¤èˆ‡å­¸ç”Ÿæ•¸é‡
            { ch: "å­¸é™¢è£¡æœ‰å¤šå°‘é–“æ•™å®¤ï¼Ÿæœ‰ 10 é–“æ•™å®¤ã€‚", sp: "Â¿CuÃ¡ntas aulas hay en la academia? Hay diez aulas en la academia." },
            { ch: "å­¸é™¢è£¡æœ‰å¤šå°‘å­¸ç”Ÿï¼Ÿå¤§ç´„æœ‰ 75 åå­¸ç”Ÿã€‚", sp: "Â¿CuÃ¡ntos alumnos hay en la academia? Hay unos setenta y cinco alumnos en nuestra academia." },

            // 06-204 & 06-205: æè¿°èˆ‡ä½ç½®
            { ch: "å“¥é›…è¡—æœ‰ä¸€é–“å’–å•¡å»³ã€‚åœ¨è¶…å¸‚æ—é‚Šã€‚", sp: "Hay una cafeterÃ­a en la calle Goya. La cafeterÃ­a estÃ¡ al lado del supermercado." },
            { ch: "å·´å‹ƒç¾…æ˜¯ä¸€ä½è¦ªåˆ‡çš„è€å¸«ã€‚", sp: "Pablo es un profesor amable." },
            { ch: "æˆ‘ç­ä¸Šå¤§ç´„æœ‰ 30 åå­¸ç”Ÿã€‚", sp: "Hay unos treinta estudiantes en mi clase." },
            { ch: "è¥¿ç­ç‰™äººå¾ˆè¦ªåˆ‡ã€‚", sp: "Los espaÃ±oles son amables." },

            // 06-206: æŒ‡ç¤ºä»£åè©ç·´ç¿’
            { ch: "ç‹—åœ¨é€™è£¡ã€‚è²“åœ¨é‚£è£¡ã€‚èƒŒåŒ…åœ¨é‚£è£¡ï¼ˆé è™•ï¼‰ã€‚", sp: "El perro estÃ¡ aquÃ­. El gato estÃ¡ ahÃ­. La mochila estÃ¡ allÃ­." },

            // 06-302: æ•™å®¤è¨­å‚™
            { ch: "æ•™å®¤åœ¨å“ªè£¡ï¼Ÿåœ¨èµ°å»Šç›¡é ­ã€‚", sp: "Â¿DÃ³nde estÃ¡ el aula? EstÃ¡ al final del pasillo." },
            { ch: "æ•™å®¤è£¡æœ‰ä¸€å¡Šé»‘æ¿å’Œä¸€äº›æ¡Œå­ã€‚æœ‰æŠ•å½±æ©Ÿå—ï¼Ÿ", sp: "Hay una pizarra y unas mesas en el aula. Â¿Hay un proyector allÃ­?" },
            { ch: "ä¸ï¼Œæ²’æœ‰æŠ•å½±æ©Ÿã€‚", sp: "No, no hay proyector." },

            // 06-401: å±…ä½ç‹€æ³
            { ch: "ä½ ç¾åœ¨ä½åœ¨å“ªè£¡ï¼Ÿæˆ‘ä½åœ¨é™„è¿‘çš„ä¸€é–“å…¬å¯“ã€‚", sp: "Â¿DÃ³nde vives ahora? Vivo en un piso por aquÃ­ cerca." },
            { ch: "æˆ‘æœ‰å…©å€‹å®¤å‹ã€‚æˆ‘ä½åœ¨äºŒæ¨“ï¼ˆè¥¿ç­ç‰™ä¸€æ¨“ï¼‰ã€‚", sp: "Tengo dos compaÃ±eras de piso. Vivo en la primera planta." },
            { ch: "æ˜¯ä¸€é–“é™„å®¶å…·çš„å…¬å¯“å—ï¼Ÿæ˜¯çš„ã€‚", sp: "Â¿Es un piso amueblado? SÃ­." }
        ],
"ç¬¬ 7 èª²ï¼šEllos son mis padres (ä»–å€‘æ˜¯æˆ‘çš„çˆ¶æ¯)": [
            // 07-101: å®¶åº­æˆå“¡èˆ‡ç…§ç‰‡ä»‹ç´¹
            { ch: "å¹´é•·çš„æ˜¯æˆ‘çš„ç¥–çˆ¶æ¯ã€‚ä»–å€‘æ˜¯èª°ï¼Ÿ", sp: "Los mayores son mis abuelos. Â¿QuiÃ©nes son?" },
            { ch: "ä»–å€‘æ˜¯æˆ‘çš„çˆ¶æ¯ï¼Œé‚£é‚Šé‚£äº›æ˜¯æˆ‘çš„å”ä¼¯èˆ…å§¨ã€‚", sp: "Ellos son mis padres y aquellos son mis tÃ­os." },
            { ch: "ä½ æœ‰å…„å¼Ÿå§Šå¦¹å—ï¼Ÿæœ‰ã€‚é€™æ˜¯æˆ‘çš„å“¥å“¥ï¼Œé€™æ˜¯æˆ‘çš„å¦¹å¦¹ã€‚", sp: "Â¿Tienes hermanos? SÃ­. Este es mi hermano mayor y esta es mi hermana menor." },

            // 07-102: äººç‰©ä»‹ç´¹èˆ‡å­©å­æ¯”è¼ƒ
            { ch: "ä½ å¥½ï¼ŒAnaã€‚é€™ä½æ˜¯ Davidï¼Œæˆ‘çš„ä¸ˆå¤«ã€‚", sp: "Hola, Ana. Este es David, mi marido." },
            { ch: "é‚£å€‹ç”·å­©æ˜¯å¦³å…’å­ï¼Œä»–å¾ˆé«˜ã€‚æ˜¯çš„ï¼Œä»–å« Miguelï¼Œäº”æ­²ï¼Œå¾ˆèª¿çš®ã€‚", sp: "Aquel chico es tu hijo. Es muy alto. SÃ­, se llama Miguel. Tiene cinco aÃ±os y es travieso." },
            { ch: "Alberto å››æ­²ï¼Œå’Œå¦³å…’å­ä¸€æ¨£èª¿çš®ã€‚ä½† Alberto æ¯” Miguel çŸ®ã€‚", sp: "Alberto tiene cuatro aÃ±os y es tan travieso como tu hijo. Pero Alberto es mÃ¡s bajo que Miguel." },

            // 07-203: æŒ‡ç¤ºä»£åè©ç·´ç¿’
            { ch: "é‚£é‚Šé‚£äº›ç”·å­©æ˜¯æˆ‘çš„åŒäº‹ã€‚é‚£å€‹å¥³å­©æ˜¯æˆ‘å¦¹å¦¹ã€‚", sp: "Aquellos chicos son mis compaÃ±eros. Esa chica es mi hermana menor." },
            { ch: "é€™ä½æ˜¯æˆ‘å…„å¼Ÿã€‚é€™æ˜¯æˆ‘å§Šå¦¹ã€‚", sp: "Este es mi hermano. Esta es mi hermana." },

            // 07-204: å½¢å®¹è©èˆ‡å‹•è©æ¯”è¼ƒç´š
            { ch: "Felisa æ¯” Elisa æ¼‚äº®ã€‚JosÃ© æ²’æœ‰ Enrique é‚£éº¼å¸¥ã€‚", sp: "Felisa es mÃ¡s guapa que Elisa. JosÃ© es menos guapo que Enrique." },
            { ch: "Luisa å’Œ LucÃ­a ä¸€æ¨£æ¼‚äº®ã€‚", sp: "Luisa es tan guapa como LucÃ­a." },
            { ch: "Felisa èªªè©±æ¯” Elisa å¤šã€‚JosÃ© åƒå¾—æ¯” Enrique å°‘ã€‚", sp: "Felisa habla mÃ¡s que Elisa. JosÃ© come menos que Enrique." },
            { ch: "æˆ‘æ“æœ‰çš„æ›¸æ¯” Pedro å¤š / å°‘ / ä¸€æ¨£å¤šã€‚", sp: "Yo tengo mÃ¡s libros que Pedro. / Yo tengo menos libros que Pedro. / Yo tengo tantos libros como Pedro." },

            // 07-205: ç‰¹æ®Šå½¢å¼æ¯”è¼ƒç´š
            { ch: "å“¥å“¥/å§Šå§Šã€‚å¼Ÿå¼Ÿ/å¦¹å¦¹ã€‚", sp: "Hermano mayor. Hermano menor." },
            { ch: "Antonio æ¯”æˆ‘å¤§ã€‚æˆ‘æ¯” Antonio å°ã€‚", sp: "Antonio es mayor que yo. Yo soy menor que Antonio." },
            { ch: "é€™å¹…ç•«æ¯”é‚£å¹…å¥½ã€‚é€™æœ¬æ›¸æ¯”é‚£æœ¬å·®ã€‚", sp: "Este cuadro es mejor que aquel. Este libro es peor que aquel." },

            // 07-302: ç…§ç‰‡æ–¹ä½æè¿°
            { ch: "é‚£å€‹é«˜å€‹å­ç”·äººæ˜¯èª°ï¼Ÿæ˜¯æˆ‘å ‚å…„å¼Ÿã€‚åœ¨ä»–å³é‚Šçš„æ˜¯æˆ‘å”å”ã€‚", sp: "Â¿QuiÃ©n es el hombre alto? Es mi primo. A la derecha de mi primo estÃ¡ mi tÃ­o." },
            { ch: "é‚£äº›å¥³äººæ˜¯èª°ã€‚ï¼Ÿ", sp: "Â¿QuiÃ©nes son las mujeres?" }, 
            { ch: "é‚£ä½å¹´é•·çš„å¥³æ€§æ˜¯æˆ‘å¬¸å¬¸ã€‚å¥¹åœ¨æˆ‘çš„å ‚å§Šå¦¹å·¦é‚Šã€‚", sp: "La mujer mayor es mi tÃ­a. EstÃ¡ a la izquierda de mi prima." },

            // 07-401: å…„å¼Ÿå§Šå¦¹è¿‘æ³
            { ch: "ä½ æœ‰å¹¾å€‹å…„å¼Ÿå§Šå¦¹ï¼Ÿ", sp: "Â¿CuÃ¡ntos hermanos tienes?" }, 
            { ch: "ä½ å“¥å“¥çµå©šäº†å—ï¼Ÿæ˜¯çš„ï¼Œä»–çµå©šäº†ï¼Œæœ‰ä¸€å€‹å…’å­ã€‚ä»–å€‘ä½åœ¨é€™é™„è¿‘ã€‚", sp: "Â¿EstÃ¡ casado tu hermano mayor? SÃ­, estÃ¡ casado y tiene un hijo. Viven cerca de aquÃ­." },
            { ch: "é‚£å¦³å¦¹å¦¹å‘¢ï¼Ÿå¥¹å–®èº«ï¼Œä½†æœ‰ç”·æœ‹å‹ã€‚", sp: "Â¿Y tu hermana menor? EstÃ¡ soltera, pero tiene novio." }
        ],
        "ç¬¬ 8 èª²ï¼šÂ¿Sabes cÃ³mo llegar allÃ­? (ä½ çŸ¥é“æ€éº¼å»é‚£è£¡å—ï¼Ÿ)": [
            // 08-101: è¦åŠƒæ—…è¡Œèˆ‡ç§Ÿè»Š
            { ch: "é€™é€±æœ«æˆ‘å€‘å» La Alberca æ€éº¼æ¨£ï¼Ÿé‚£æ˜¯å€‹é™„è¿‘çš„æ‘èŠã€‚", sp: "Â¿QuÃ© tal si vamos a La Alberca este fin de semana? Es un pueblo cercano." },
            { ch: "å¥½ä¸»æ„ã€‚ä½ çŸ¥é“æ€éº¼å»é‚£è£¡ä»¥åŠæˆ‘å€‘ä½å“ªè£¡å—ï¼Ÿ", sp: "Buena idea. Â¿Sabes cÃ³mo llegar allÃ­ y dÃ³nde nos alojamos?" },
            { ch: "æˆ‘ä¸æ€éº¼äº†è§£é‚£å€‹æ‘èŠï¼Œä½†æˆ‘å€‘å¯ä»¥ä¸Šç¶²æœå°‹ã€‚", sp: "No conozco muy bien ese pueblo, pero podemos buscar por internet." },
            { ch: "ä½ çŸ¥é“å“ªè£¡å¯ä»¥ç§Ÿè»Šå—ï¼Ÿæ˜¯çš„ï¼Œæˆ‘èªè­˜é€™é™„è¿‘çš„ä¸€å®¶ç§Ÿè»Šåº—ã€‚", sp: "Â¿Sabes dÃ³nde podemos alquilar un coche? SÃ­, conozco un alquiler de coches cerca de aquÃ­." },

            // 08-102: äººç‰©èƒŒæ™¯ï¼ˆå°ç£äºº Emiliaï¼‰
            { ch: "ä½ èªè­˜é‚£å€‹å¥³äººå—ï¼Ÿæ˜¯çš„ï¼Œå¥¹æ˜¯ Emiliaï¼ŒEnrique çš„å¥³æœ‹å‹ã€‚", sp: "Â¿Conoces a esa mujer? SÃ­, es Emilia, la novia de Enrique." },
            { ch: "å¥¹æ˜¯å°ç£äººï¼Œä½†å¥¹è¥¿ç­ç‰™æ–‡å’Œæ³•æ–‡éƒ½èªªå¾—å¾ˆå¥½ã€‚", sp: "Es taiwanesa, pero sabe muy bien espaÃ±ol y francÃ©s." },
            { ch: "å¥¹å’Œ Enrique æ˜¯è¾¦å…¬å®¤åŒäº‹ã€‚", sp: "Enrique y ella son compaÃ±eros de oficina." },

            // 08-202 & 08-203: Saber / Conocer / Poder ç·´ç¿’
            { ch: "ä½ çŸ¥é“ Enrique æœ‰å€‹å¥³å…’å—ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚", sp: "Â¿Sabes que Enrique tiene una hija? No lo sÃ©." },
            { ch: "æˆ‘ä¸çŸ¥é“è»Šç«™åœ¨å“ªè£¡ã€‚", sp: "No sÃ© dÃ³nde estÃ¡ la estaciÃ³n." },
            { ch: "ä½ çŸ¥é“æ€éº¼ä½¿ç”¨é€™å°ç›¸æ©Ÿå—ï¼ŸæŠ±æ­‰ï¼Œæˆ‘ä¸çŸ¥é“ã€‚", sp: "Â¿Sabes cÃ³mo usar la cÃ¡mara? Lo siento, no lo sÃ©." },
            { ch: "Alicia çš„è¥¿ç­ç‰™æ–‡éå¸¸å¥½ã€‚Elisa ä¸€é»éƒ½ä¸æ‡‚ã€‚", sp: "Alicia sabe muy bien espaÃ±ol. Elisa no sabe nada de espaÃ±ol." },
            { ch: "MarÃ­a éå¸¸äº†è§£å°å—ã€‚ä½ èªè­˜ Emilia å—ï¼Ÿ", sp: "MarÃ­a conoce muy bien Tainan. Â¿Conoces a Emilia?" },
            { ch: "æˆ‘ä¸èƒ½å”±æ­Œï¼Œå› ç‚ºæˆ‘æ„Ÿå†’äº†ã€‚", sp: "No puedo cantar porque estoy resfriado." },
            { ch: "ä½ å¯ä»¥ä¾†æ©Ÿå ´æ¥æˆ‘å—ï¼Ÿ", sp: "Â¿Puedes recogerme en el aeropuerto?" },
            { ch: "æˆ‘å…„å¼Ÿæœƒè¸¢è¶³çƒã€‚", sp: "Mi hermano sabe jugar al fÃºtbol." },

            // 08-302: æ‘èŠä¼‘é–’å»ºè­°
            { ch: "ä½ å°é€™å€‹æ‘èŠç†Ÿæ‚‰å—ï¼Ÿæœ‰ä¸€é»ã€‚", sp: "Â¿Conoces bien este pueblo? Un poco." },
            { ch: "ä½ çŸ¥é“å“ªè£¡å¯ä»¥é‡é¤å—ï¼Ÿæˆ‘èªè­˜é€™é™„è¿‘çš„ä¸€å€‹å…¬åœ’ã€‚", sp: "Â¿Sabes dÃ³nde puedo hacer picnic? Conozco un parque cerca de aquÃ­." },
            { ch: "é‚£å“ªè£¡å¯ä»¥å–å’–å•¡ï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œä½†æˆ‘å€‘å¯ä»¥ä¸Šç¶²æ‰¾ã€‚", sp: "Â¿Y dÃ³nde puedo tomar cafÃ©? No lo sÃ©, pero podemos buscar por internet." },

            // 08-401: éœ²ç‡Ÿèˆ‡è¥¿ç­ç‰™ç¾é£Ÿè¨ˆç•«
            { ch: "å’Œ Eva åŠ Enrique ä¸€èµ·å»éœ²ç‡Ÿæ€éº¼æ¨£ï¼Ÿå¥½ä¸»æ„ã€‚", sp: "Â¿QuÃ© tal si vamos de camping con Eva y Enrique? Buena idea." },
            { ch: "æˆ‘å€‘å¯ä»¥åœ¨é‚£è£¡çƒ¤è‚‰å’Œåšè¥¿ç­ç‰™å¤§é‹é£¯ã€‚", sp: "Podemos hacer barbacoa y paella allÃ­." },
            { ch: "ä½ æœƒåšå¤§é‹é£¯å—ï¼Ÿç•¶ç„¶ã€‚æ­¤å¤–ï¼Œæˆ‘é‚„è¦åšæ°´æœé…’å’Œé–‹èƒƒèœã€‚", sp: "Â¿Sabes cÃ³mo hacer paella? Por supuesto. AdemÃ¡s, voy a hacer sangrÃ­a y tapas." }
        ],
    };

    let currentLesson = [];
    let currentIndex = 0;
    let currentScore = 0;
    let selectedLessonName = "";

    // 1. åˆå§‹åŒ–é¸å–®
    function initMenu() {
        const menu = document.getElementById('lesson-menu');
        menu.innerHTML = "";
        Object.keys(allLessons).forEach(name => {
            const btn = document.createElement('button');
            btn.className = 'lesson-btn';
            btn.innerText = name;
            btn.onclick = () => startLesson(name);
            menu.appendChild(btn);
        });
    }

    // 2. é–‹å§‹ç‰¹å®šèª²ç¨‹
    function startLesson(name) {
        selectedLessonName = name;
        currentLesson = [...allLessons[name]].sort(() => Math.random() - 0.5); // éš¨æ©Ÿæ´—ç‰Œ
        currentIndex = 0;
        currentScore = 0;
        
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        document.getElementById('current-lesson-name').innerText = name;
        showQuestion();
    }

   // 3. é¡¯ç¤ºé¡Œç›®ï¼ˆæ–°å¢ï¼šè¼¸å…¥æ¡†ç›£è½å™¨ï¼‰
    function showQuestion() {
        const q = currentLesson[currentIndex];
        document.getElementById('chinese-text').innerText = q.ch;
        
        const userInput = document.getElementById('user-input');
        userInput.value = "";
        userInput.style.borderColor = "#ddd"; // æ¢å¾©é‚Šæ¡†é¡è‰²
        
        document.getElementById('feedback').innerText = "";
        document.getElementById('ans-display').style.display = "none";
        
        const checkBtn = document.getElementById('check-btn');
        checkBtn.disabled = false;
        checkBtn.innerText = "æª¢æŸ¥ç­”æ¡ˆ";

        document.getElementById('progress').innerText = `${currentIndex + 1} / ${currentLesson.length}`;
        document.getElementById('score').innerText = `å¾—åˆ†: ${currentScore}`;
        userInput.focus();

        // ã€ä¿®æ­£é»ã€‘ç›£è½è¼¸å…¥äº‹ä»¶ï¼šç•¶ä½¿ç”¨è€…æ‰“å­—æ™‚ï¼Œé‡æ–°å•Ÿç”¨æŒ‰éˆ•
        userInput.oninput = function() {
            checkBtn.disabled = false;
            checkBtn.innerText = "æª¢æŸ¥ç­”æ¡ˆ";
            userInput.style.borderColor = "#007AFF"; 
        };
    }

    // 4. æª¢æŸ¥ç­”æ¡ˆ
    // è¼”åŠ©å‡½æ•¸ï¼šå»é™¤é‡éŸ³ç¬¦è™Ÿä»¥é€²è¡Œæ¯”å°
    function removeAccents(str) {
        return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    }

    function checkAnswer() {
        const userInput = document.getElementById('user-input');
        const rawUserValue = userInput.value.trim();
        
        // æ­£è¦åŒ–ï¼šè½‰å°å¯«ã€å»æ¨™é»ã€å»é‡éŸ³
        const userClean = removeAccents(rawUserValue.toLowerCase().replace(/[Â¿?.,!]/g, ""));
        const correctClean = removeAccents(currentLesson[currentIndex].sp.toLowerCase().replace(/[Â¿?.,!]/g, ""));
        
        const feedback = document.getElementById('feedback');
        const ansDisp = document.getElementById('ans-display');
        const checkBtn = document.getElementById('check-btn');

        if (userClean === correctClean) {
            // åˆ¤å®šæ­£ç¢º
            currentScore += 10;
            
            // æª¢æŸ¥æ˜¯å¦æœ‰é‡éŸ³æ‰“éŒ¯ï¼ˆåŸå§‹å­—ä¸²æ¯”å°ï¼‰
            const isAccentsPerfect = rawUserValue.replace(/[Â¿?.,!]/g, "") === currentLesson[currentIndex].sp.replace(/[Â¿?.,!]/g, "");
            
            if (!isAccentsPerfect) {
                feedback.innerText = "ç­”å°äº†ï¼ä½†è¦æ³¨æ„é‡éŸ³ç¬¦è™Ÿï¼š";
                feedback.style.color = "#FF9500"; // æ©˜è‰²æé†’
            } else {
                feedback.innerText = "Â¡Perfecto! å…¨å°ï¼ğŸŒŸ";
                feedback.style.color = "var(--success)";
            }

            // è™•ç†é¡¯ç¤ºç­”æ¡ˆï¼šå°‡å«æœ‰ç‰¹æ®Šç¬¦è™Ÿçš„å–®å­—è®Šç´…
            const words = currentLesson[currentIndex].sp.split(' ');
            const highlightedAns = words.map(word => {
                // å¦‚æœå–®å­—åŒ…å«ç‰¹æ®Šå­—å…ƒï¼Œå‰‡æ¨™ç´…
                if (/[Ã¡Ã©Ã­Ã³ÃºÃ±ÃÃ‰ÃÃ“ÃšÃ‘]/.test(word)) {
                    return `<span style="color: red; font-weight: bold;">${word}</span>`;
                }
                return word;
            }).join(' ');

            userInput.style.borderColor = "var(--success)";
            ansDisp.innerHTML = highlightedAns + " ğŸ”Š";
            ansDisp.style.display = "block";
            checkBtn.disabled = true;
            checkBtn.innerText = "å·²å®Œæˆ";
            speak();
        } else {
            // åˆ¤å®šéŒ¯èª¤
            feedback.innerText = "æ‹¼å­—æœ‰èª¤ï¼Œå†è©¦è©¦çœ‹ï¼";
            feedback.style.color = "var(--danger)";
            userInput.style.borderColor = "var(--danger)";
            
            ansDisp.innerText = "æŸ¥çœ‹æ­£ç¢ºç­”æ¡ˆï¼Ÿ (é»æ“Šæ­¤è™•) ğŸ”Š";
            ansDisp.onclick = function() {
                // éŒ¯èª¤æ™‚æŸ¥çœ‹ç­”æ¡ˆä¹Ÿé¡¯ç¤ºç´…å­—æé†’
                const words = currentLesson[currentIndex].sp.split(' ');
                ansDisp.innerHTML = words.map(word => /[Ã¡Ã©Ã­Ã³ÃºÃ±ÃÃ‰ÃÃ“ÃšÃ‘]/.test(word) ? `<span style="color: red;">${word}</span>` : word).join(' ') + " ğŸ”Š";
                speak();
            };
            ansDisp.style.display = "block";
        }
    }

    // 5. ä¸‹ä¸€é¡Œ
    function nextQuestion() {
        if (currentIndex < currentLesson.length - 1) {
            currentIndex++;
            showQuestion();
        } else {
            alert(`èª²ç¨‹å®Œæˆï¼ç¸½åˆ†ï¼š${currentScore}`);
            goToMenu();
        }
    }

    function goToMenu() {
        document.getElementById('menu-screen').style.display = 'block';
        document.getElementById('quiz-screen').style.display = 'none';
    }

    function speak() {
        const utterance = new SpeechSynthesisUtterance(currentLesson[currentIndex].sp);
        utterance.lang = 'es-ES';
        window.speechSynthesis.speak(utterance);
    }

    initMenu();
</script>

</body>
</html>








