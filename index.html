<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿èªå­¸ç¿’å¤§å¸« - 20èª²å…¨é›†</title>
    <style>
        :root { --primary: #007AFF; --secondary: #6c757d; --success: #34C759; --danger: #FF3B30; }
        body { font-family: -apple-system, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { width: 90%; max-width: 450px; padding: 25px; background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        
        /* é¸å–®æ¨£å¼ */
        .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 20px; max-height: 400px; overflow-y: auto; padding: 5px; }
        .lesson-btn { background: white; border: 2px solid var(--primary); color: var(--primary); padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .lesson-btn:hover { background: var(--primary); color: white; }

        /* ç·´ç¿’å€æ¨£å¼ */
        .quiz-container { display: none; }
        .stats-bar { display: flex; justify-content: space-between; font-size: 14px; color: #666; margin-bottom: 15px; }
        #chinese-text { font-size: 22px; font-weight: bold; margin: 20px 0; min-height: 50px; color: #333; }
        input[type="text"] { width: 100%; padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 12px; margin-bottom: 15px; text-align: center; outline: none; }
        input[type="text"]:focus { border-color: var(--primary); }
        .ans-display { font-size: 18px; color: var(--primary); font-weight: bold; margin-bottom: 15px; display: none; background: #eef7ff; padding: 10px; border-radius: 10px; cursor: pointer; }
        
        button.action-btn { width: 100%; border: none; padding: 15px; border-radius: 12px; font-size: 18px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .btn-check { background: var(--primary); color: white; }
        .btn-next { background: var(--secondary); color: white; }
        .btn-back { background: none; color: var(--secondary); font-size: 14px; text-decoration: underline; }
    </style>
</head>
<body>

<div class="card" id="menu-screen">
    <h2 style="margin-top:0">é¸æ“‡èª²ç¨‹</h2>
    <p style="color:#666">å…± 20 èª²ï¼Œé»æ“Šé–‹å§‹ç·´ç¿’</p>
    <div class="menu-grid" id="lesson-menu">
        </div>
</div>

<div class="card quiz-container" id="quiz-screen">
    <div class="stats-bar">
        <div id="current-lesson-name">Lesson 7</div>
        <div id="progress">1 / 10</div>
        <div id="score">å¾—åˆ†: 0</div>
    </div>
    
    <div id="chinese-text">é¡Œç›®è¼‰å…¥ä¸­...</div>
    <input type="text" id="user-input" placeholder="è«‹è¼¸å…¥è¥¿æ–‡..." autocomplete="off">
    
    <div id="feedback" style="margin-bottom:10px; font-weight:bold;"></div>
    <div id="ans-display" class="ans-display" onclick="speak()"></div>

    <div class="btn-group">
        <button id="check-btn" class="action-btn btn-check" onclick="checkAnswer()">æª¢æŸ¥ç­”æ¡ˆ</button>
        <button class="action-btn btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ</button>
        <button class="btn-back" onclick="goToMenu()">å›ä¸»é¸å–®</button>
    </div>
</div>

<script>
    // --- é¡Œåº«è³‡æ–™å€ (ä½ å¯ä»¥åœ¨é€™è£¡æŒçºŒå¢åŠ åˆ° 20 èª²) ---
    const allLessons = {

"ç¬¬ 5 èª²ï¼šÂ¿DÃ³nde estÃ¡ la estaciÃ³n? (è»Šç«™åœ¨å“ªè£¡ï¼Ÿ)": [
            // 05-101: å•è·¯
            { ch: "ä¸å¥½æ„æ€ï¼Œæ™®æ‹‰å¤šåšç‰©é¤¨åœ¨å“ªè£¡ï¼Ÿ", sp: "Perdone, Â¿dÃ³nde estÃ¡ el museo del Prado?" },
            { ch: "é›¢é€™è£¡æœ‰ä¸€é»é ã€‚ä½ å¾—æ­åœ°éµã€‚", sp: "EstÃ¡ un poco lejos de aquÃ­. Tienes que coger el metro." },
            { ch: "åœ°éµç«™åœ¨å“ªè£¡ï¼Ÿé›¢é€™è£¡å¾ˆè¿‘ã€‚å°±åœ¨æ›¸å ±æ”¤å°é¢ã€‚", sp: "Â¿DÃ³nde estÃ¡ la estaciÃ³n de metro? EstÃ¡ cerca de aquÃ­. EstÃ¡ enfrente del quiosco." },
            { ch: "éå¸¸æ„Ÿè¬ã€‚ / ä¸å®¢æ°£ã€‚", sp: "Muchas gracias. De nada." },
            
            // 05-102: æ„å¤–ç›¸é‡
            { ch: "å—¨ï¼Œå®‰æ±å°¼å¥§ã€‚çœŸå·§ã€‚ä½ ä½åœ¨é€™é™„è¿‘å—ï¼Ÿ", sp: "Hola, Antonio. QuÃ© casualidad. Â¿Vives cerca de aquÃ­?" },
            { ch: "ä¸ï¼Œæˆ‘åœ¨é€™è£¡æ˜¯å› ç‚ºæˆ‘å’Œå¥³æœ‹å‹æœ‰ç´„ã€‚", sp: "No, estoy aquÃ­ porque tengo una cita con mi novia." },
            { ch: "ä½ ç¾åœ¨ä½åœ¨å“ªè£¡ï¼Ÿæˆ‘ä½åœ¨åˆç§Ÿå…¬å¯“ã€‚å…¬å¯“åœ¨ç´¢é‡Œäºè¡—ã€‚", sp: "Â¿DÃ³nde vives ahora? Vivo en un piso compartido. El piso estÃ¡ en la calle Zorrilla." },
            
            // 05-206: æƒ…æ„Ÿç‹€æ…‹
            { ch: "æˆ‘ç­‹ç–²åŠ›ç«­ï¼Œå› ç‚ºæˆ‘æœ‰å¾ˆå¤šå·¥ä½œã€‚", sp: "Estoy agotado porque tengo mucho trabajo." },
            
            // 05-204 & 05-302: å±…ä½ä½ç½®èˆ‡æ–¹ä½ç·´ç¿’
            { ch: "ä½ ä¾†è‡ªå“ªè£¡ï¼Ÿæˆ‘ä¾†è‡ªé¦¬å¾·é‡Œã€‚", sp: "Â¿De dÃ³nde eres tÃº? Yo soy de Madrid." },
            { ch: "ä½ ä½åœ¨å“ªè£¡ï¼Ÿæˆ‘å’Œæœ‹å‹ä½åœ¨ä¸€é–“å…¬å¯“è£¡ã€‚", sp: "Â¿DÃ³nde vives? Vivo en un piso con mi amigo." },
            { ch: "å…¬å¯“åœ¨å“ªè£¡ï¼Ÿå…¬å¯“åœ¨ä¸€å®¶éºµåŒ…åº—å°é¢ã€‚", sp: "Â¿DÃ³nde estÃ¡ el piso? El piso estÃ¡ enfrente de una panaderÃ­a." },
            { ch: "éºµåŒ…åº—åœ¨å“ªè£¡ï¼Ÿå®ƒåœ¨æ•™å ‚å‰é¢ï¼Œå»£å ´å¾Œé¢ã€‚", sp: "Â¿DÃ³nde estÃ¡ la panaderÃ­a? EstÃ¡ delante de la iglesia y detrÃ¡s de la plaza." },
            { ch: "å…¬å¯“åœ¨å ±æ”¤æ—é‚Šå—ï¼Ÿå…¬å¯“å°±åœ¨é‚£è£¡ã€‚", sp: "Â¿EstÃ¡ el piso al lado de un quiosco? AllÃ­ estÃ¡ el piso." },
            
            // 05-401: Elisa çš„è¿‘æ³èˆ‡æ–°å®¶
            { ch: "Elisaï¼Œå¦³ä¸ˆå¤«åœ¨å“ªè£¡ï¼Ÿä»–åœ¨æ³•åœ‹å‡ºå·®ã€‚", sp: "Elisa, Â¿dÃ³nde estÃ¡ tu marido? EstÃ¡ de viaje de negocios por Francia." },
            { ch: "æ˜å¤©ä»–åœ¨å·´é»æœ‰ä¸€å€‹æœƒè­°ã€‚", sp: "MaÃ±ana tiene una reuniÃ³n en ParÃ­s." },
            { ch: "ä½ å€‘ç¾åœ¨ä½åœ¨é¦¬å¾·é‡Œå—ï¼Ÿä¸ï¼Œæˆ‘å€‘åœ¨è–©æ‹‰æ›¼å¡è²·äº†ä¸€æ£Ÿåˆ¥å¢…ã€‚", sp: "Â¿VivÃ­s en Madrid ahora? No, mi marido y yo compramos un chalÃ© en Salamanca." },
            { ch: "é›¢å¸‚ä¸­å¿ƒæœ‰é»é ï¼Œä½†åœ¨ä¸€å€‹éå¸¸å®‰éœçš„å€åŸŸã€‚", sp: "EstÃ¡ un poco lejos del centro, pero estÃ¡ en una zona muy tranquila." },
            
            // é¡å¤–ç·´ç¿’
            { ch: "æ‰‹æ©Ÿåœ¨å“ªè£¡ï¼Ÿæ‰‹æ©Ÿåœ¨æ¡Œå­ä¸Šã€‚", sp: "Â¿DÃ³nde estÃ¡ el mÃ³vil? El mÃ³vil estÃ¡ encima de la mesa." },
            { ch: "ä½ çˆ¶è¦ªåœ¨å“ªè£¡å·¥ä½œï¼Ÿæˆ‘çˆ¶è¦ªåœ¨ä¸€æ‰€å­¸æ ¡å·¥ä½œã€‚", sp: "Â¿DÃ³nde trabaja tu padre? Mi padre trabaja en una escuela." }
        ],

    };

    let currentLesson = [];
    let currentIndex = 0;
    let currentScore = 0;
    let selectedLessonName = "";

    // 1. åˆå§‹åŒ–é¸å–®
    function initMenu() {
        const menu = document.getElementById('lesson-menu');
        menu.innerHTML = "";
        Object.keys(allLessons).forEach(name => {
            const btn = document.createElement('button');
            btn.className = 'lesson-btn';
            btn.innerText = name;
            btn.onclick = () => startLesson(name);
            menu.appendChild(btn);
        });
    }

    // 2. é–‹å§‹ç‰¹å®šèª²ç¨‹
    function startLesson(name) {
        selectedLessonName = name;
        currentLesson = [...allLessons[name]].sort(() => Math.random() - 0.5); // éš¨æ©Ÿæ´—ç‰Œ
        currentIndex = 0;
        currentScore = 0;
        
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        document.getElementById('current-lesson-name').innerText = name;
        showQuestion();
    }

   // 3. é¡¯ç¤ºé¡Œç›®ï¼ˆæ–°å¢ï¼šè¼¸å…¥æ¡†ç›£è½å™¨ï¼‰
    function showQuestion() {
        const q = currentLesson[currentIndex];
        document.getElementById('chinese-text').innerText = q.ch;
        
        const userInput = document.getElementById('user-input');
        userInput.value = "";
        userInput.style.borderColor = "#ddd"; // æ¢å¾©é‚Šæ¡†é¡è‰²
        
        document.getElementById('feedback').innerText = "";
        document.getElementById('ans-display').style.display = "none";
        
        const checkBtn = document.getElementById('check-btn');
        checkBtn.disabled = false;
        checkBtn.innerText = "æª¢æŸ¥ç­”æ¡ˆ";

        document.getElementById('progress').innerText = `${currentIndex + 1} / ${currentLesson.length}`;
        document.getElementById('score').innerText = `å¾—åˆ†: ${currentScore}`;
        userInput.focus();

        // ã€ä¿®æ­£é»ã€‘ç›£è½è¼¸å…¥äº‹ä»¶ï¼šç•¶ä½¿ç”¨è€…æ‰“å­—æ™‚ï¼Œé‡æ–°å•Ÿç”¨æŒ‰éˆ•
        userInput.oninput = function() {
            checkBtn.disabled = false;
            checkBtn.innerText = "æª¢æŸ¥ç­”æ¡ˆ";
            userInput.style.borderColor = "#007AFF"; 
        };
    }

    // 4. æª¢æŸ¥ç­”æ¡ˆ
    // è¼”åŠ©å‡½æ•¸ï¼šå»é™¤é‡éŸ³ç¬¦è™Ÿä»¥é€²è¡Œæ¯”å°
    function removeAccents(str) {
        return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    }

    function checkAnswer() {
        const userInput = document.getElementById('user-input');
        const rawUserValue = userInput.value.trim();
        
        // æ­£è¦åŒ–ï¼šè½‰å°å¯«ã€å»æ¨™é»ã€å»é‡éŸ³
        const userClean = removeAccents(rawUserValue.toLowerCase().replace(/[Â¿?.,!]/g, ""));
        const correctClean = removeAccents(currentLesson[currentIndex].sp.toLowerCase().replace(/[Â¿?.,!]/g, ""));
        
        const feedback = document.getElementById('feedback');
        const ansDisp = document.getElementById('ans-display');
        const checkBtn = document.getElementById('check-btn');

        if (userClean === correctClean) {
            // åˆ¤å®šæ­£ç¢º
            currentScore += 10;
            
            // æª¢æŸ¥æ˜¯å¦æœ‰é‡éŸ³æ‰“éŒ¯ï¼ˆåŸå§‹å­—ä¸²æ¯”å°ï¼‰
            const isAccentsPerfect = rawUserValue.replace(/[Â¿?.,!]/g, "") === currentLesson[currentIndex].sp.replace(/[Â¿?.,!]/g, "");
            
            if (!isAccentsPerfect) {
                feedback.innerText = "ç­”å°äº†ï¼ä½†è¦æ³¨æ„é‡éŸ³ç¬¦è™Ÿï¼š";
                feedback.style.color = "#FF9500"; // æ©˜è‰²æé†’
            } else {
                feedback.innerText = "Â¡Perfecto! å…¨å°ï¼ğŸŒŸ";
                feedback.style.color = "var(--success)";
            }

            // è™•ç†é¡¯ç¤ºç­”æ¡ˆï¼šå°‡å«æœ‰ç‰¹æ®Šç¬¦è™Ÿçš„å–®å­—è®Šç´…
            const words = currentLesson[currentIndex].sp.split(' ');
            const highlightedAns = words.map(word => {
                // å¦‚æœå–®å­—åŒ…å«ç‰¹æ®Šå­—å…ƒï¼Œå‰‡æ¨™ç´…
                if (/[Ã¡Ã©Ã­Ã³ÃºÃ±ÃÃ‰ÃÃ“ÃšÃ‘]/.test(word)) {
                    return `<span style="color: red; font-weight: bold;">${word}</span>`;
                }
                return word;
            }).join(' ');

            userInput.style.borderColor = "var(--success)";
            ansDisp.innerHTML = highlightedAns + " ğŸ”Š";
            ansDisp.style.display = "block";
            checkBtn.disabled = true;
            checkBtn.innerText = "å·²å®Œæˆ";
            speak();
        } else {
            // åˆ¤å®šéŒ¯èª¤
            feedback.innerText = "æ‹¼å­—æœ‰èª¤ï¼Œå†è©¦è©¦çœ‹ï¼";
            feedback.style.color = "var(--danger)";
            userInput.style.borderColor = "var(--danger)";
            
            ansDisp.innerText = "æŸ¥çœ‹æ­£ç¢ºç­”æ¡ˆï¼Ÿ (é»æ“Šæ­¤è™•) ğŸ”Š";
            ansDisp.onclick = function() {
                // éŒ¯èª¤æ™‚æŸ¥çœ‹ç­”æ¡ˆä¹Ÿé¡¯ç¤ºç´…å­—æé†’
                const words = currentLesson[currentIndex].sp.split(' ');
                ansDisp.innerHTML = words.map(word => /[Ã¡Ã©Ã­Ã³ÃºÃ±ÃÃ‰ÃÃ“ÃšÃ‘]/.test(word) ? `<span style="color: red;">${word}</span>` : word).join(' ') + " ğŸ”Š";
                speak();
            };
            ansDisp.style.display = "block";
        }
    }

    // 5. ä¸‹ä¸€é¡Œ
    function nextQuestion() {
        if (currentIndex < currentLesson.length - 1) {
            currentIndex++;
            showQuestion();
        } else {
            alert(`èª²ç¨‹å®Œæˆï¼ç¸½åˆ†ï¼š${currentScore}`);
            goToMenu();
        }
    }

    function goToMenu() {
        document.getElementById('menu-screen').style.display = 'block';
        document.getElementById('quiz-screen').style.display = 'none';
    }

    function speak() {
        const utterance = new SpeechSynthesisUtterance(currentLesson[currentIndex].sp);
        utterance.lang = 'es-ES';
        window.speechSynthesis.speak(utterance);
    }

    initMenu();
</script>

</body>
</html>







